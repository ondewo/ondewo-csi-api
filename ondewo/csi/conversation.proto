// Copyright 2021-2025 ONDEWO GmbH
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

syntax = "proto3";

package ondewo.csi;
import "google/protobuf/empty.proto";
import "google/rpc/status.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/struct.proto";
import "ondewo/nlu/session.proto";
import "ondewo/t2s/text-to-speech.proto";
import "ondewo/s2t/speech-to-text.proto";
import "ondewo/nlu/context.proto";
import "google/protobuf/any.proto";

// <p>Endpoints of CSI service.</p>
service Conversations {
    // <p>Create the S2S pipeline specified in the request message. The pipeline with the specified ID must not exist.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext -d '{
    //   "id": "pizza",
    //   "s2t_pipeline_id": "default_german",
    //   "nlu_project_id": "1f3425d2-41fd-4970-87e6-88e8e121bb49",
    //   "nlu_language_code": "de",
    //   "t2s_pipeline_id": "default_german"
    // }' localhost:50051 ondewo.csi.Conversations.CreateS2sPipeline
    // </pre>
    // <samp>{}</samp>
    rpc CreateS2sPipeline (S2sPipeline) returns (google.protobuf.Empty) {};

    // <p>Retrieve the S2S pipeline with the ID specified in the request message.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext -d '{"id": "pizza"}' localhost:50051 ondewo.csi.Conversations.GetS2sPipeline
    // </pre>
    // <samp>{
    //   "id": "pizza",
    //   "s2t_pipeline_id": "default_german",
    //   "nlu_project_id": "1f3425d2-41fd-4970-87e6-88e8e121bb49",
    //   "nlu_language_code": "de",
    //   "t2s_pipeline_id": "default_german"
    // }
    // </samp>
    rpc GetS2sPipeline (S2sPipelineId) returns (S2sPipeline) {};

    // <p>Update the S2S pipeline specified in the request message. The pipeline must exist.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext -d '{
    //   "id": "pizza",
    //   "s2t_pipeline_id": "default_german",
    //   "nlu_project_id": "1f3425d2-41fd-4970-87e6-88e8e121bb49",
    //   "nlu_language_code": "en",
    //   "t2s_pipeline_id": "default_german"
    // }' localhost:50051 ondewo.csi.Conversations.UpdateS2sPipeline
    // </pre>
    // <samp>{}</samp>
    rpc UpdateS2sPipeline (S2sPipeline) returns (google.protobuf.Empty) {};

    // <p>Delete the S2S pipeline with the ID specified in the request message. The pipeline must exist.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext -d '{"id": "pizza"}' localhost:50051 ondewo.csi.Conversations.DeleteS2sPipeline
    // </pre>
    // <samp>{}</samp>
    rpc DeleteS2sPipeline (S2sPipelineId) returns (google.protobuf.Empty) {};

    // <p>List all S2S pipelines of the server.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext localhost:50051 ondewo.csi.Conversations.ListS2sPipelines
    // </pre>
    // <samp>{
    //   "pipelines": [
    //     {
    //       "id": "pizza",
    //       "s2t_pipeline_id": "default_german",
    //       "nlu_project_id": "1f3425d2-41fd-4970-87e6-88e8e121bb49",
    //       "nlu_language_code": "de",
    //       "t2s_pipeline_id": "default_german"
    //     }
    //   ]
    // }</samp>
    rpc ListS2sPipelines (ListS2sPipelinesRequest) returns (ListS2sPipelinesResponse) {};

    // <p>Processes a natural language query in audio format in a streaming fashion and returns structured, actionable data as a result.</p>
    rpc S2sStream (stream S2sStreamRequest) returns (stream S2sStreamResponse) {};

    // <p>Check the health of S2T, NLU and T2S servers.</p>
    //
    // <p>Examples:</p>
    //
    // <pre>
    // grpcurl -plaintext localhost:50051 ondewo.csi.Conversations.CheckUpstreamHealth
    // </pre>
    //
    // All upstreams healthy:
    // <samp>{}</samp>
    //
    // All upstreams unhealthy:
    // <samp>{
    //   "s2t_status": {
    //     "code": 14,
    //     "message": "failed to connect to all addresses"
    //   },
    //   "nlu_status": {
    //     "code": 14,
    //     "message": "failed to connect to all addresses"
    //   },
    //   "t2s_status": {
    //     "code": 14,
    //     "message": "failed to connect to all addresses"
    //   }
    // }</samp>
    rpc CheckUpstreamHealth(google.protobuf.Empty) returns (CheckUpstreamHealthResponse) {};

    // <p>Get the control stream to control sip, t2s, s2t etc. during a conversation.</p>
    rpc GetControlStream (ControlStreamRequest) returns (stream ControlStreamResponse) {};

    // <p>Send a message on the control stream to control sip, t2s, s2t etc. during a conversation.</p>
    rpc SetControlStatus (SetControlStatusRequest) returns (SetControlStatusResponse) {};

}

// The top-level message sent by client to <code>CreateS2sPipeline</code> and <code>UpdateS2sPipeline</code> endpoints and received from <code>GetS2sPipeline</code> endpoint.
message S2sPipeline {

    // Required. CSI pipeline identifier consisting of S2T, NLU and T2S configuration. ID can be any non-empty string.
    string id = 1;

    // Required. S2T pipeline ID, e.g. "german_general"
    string s2t_pipeline_id = 2;

    // Required. NLU project ID, usually a hash, e.g. "ae33586b-x2s2-494a-aa73-1af0589cfc56".
    string nlu_project_id = 3;

    // Required. Language code present in the corresponding NLU project, e.g. "de".
    string nlu_language_code = 4;

    // Required. T2S pipeline ID, e.g. "kerstin".
    string t2s_pipeline_id = 5;

}

// The top-level message sent by client to <code>GetS2sPipeline</code> and <code>DeleteS2sPipeline</code> endpoints.
message S2sPipelineId {

    // Required. CSI pipeline identifier.
    string id = 1;

}

// The top-level message sent by client to <code>ListS2sPipelines</code> endpoint. Currently without arguments.
message ListS2sPipelinesRequest {
    // TODO: add filtering options
}

// The top-level message received from <code>ListS2sPipelines</code> endpoint.
message ListS2sPipelinesResponse {

    // Collection of S2S pipelines of the server.
    repeated S2sPipeline pipelines = 1;

}

// The top-level message sent by the client to the <code>S2sStream</code> method.
// Multiple request messages should be sent in order:
// <ul>
//   <li>The first message must contain <code>pipeline_id</code> and can contain <code>session_id</code> or <code>initial_intent_display_name</code>. The message must not contain <code>audio</code> nor <code>end_of_stream</code>.</li>
//   <li>All subsequent messages must contain <code>audio</code>. If <code>end_of_stream</code> is <code>true</code>, the stream is closed.</li>
// </ul>
message S2sStreamRequest {

    // Optional. The CSI pipeline ID specified in the initial request.
    string pipeline_id = 1;

    // <p>Optional. The session or call ID specified in the initial request. It&apos;s up to the API caller to choose an appropriate string. It can be a random number or some type of user identifier (preferably hashed).</p>
    string session_id = 2;

    // Optional. The input audio content to be recognized.
    bytes audio = 3;
    // If <code>true</code>, the recognizer will not return any further hypotheses about this piece of the audio. May only be populated for <code>event_type</code> = <code>RECOGNITION_EVENT_TRANSCRIPT</code>.
    bool end_of_stream = 4;

    // Optional. Intent display name to trigger in NLU system in the beginning of the conversation.
    string initial_intent_display_name = 5;

}

// The top-level message returned from the <code>S2sStream</code> method.
// A response message is returned for each utterance of the input stream. It contains the full response from NLU system in <code>detect_intent_response</code> or the full T2S response in <code>synthesize_response</code>.
// Multiple response messages can be returned in order:
// <ul>
//   <li>The first response message for an input utterance contains response from NLU system <code>detect_intent_response</code> with detected intent and N fulfillment messages (N &gt;= 0).</li>
//   <li>The next N response messages contain for each fulfillment message one of the following:
//     <ul>
//       <li>T2S response <code>synthesize_response</code> with synthesized audio</li>
//       <li>SIP trigger message <code>sip_trigger</code> with SIP trigger extracted from the fulfillment message</li>
//     </ul>
//   </li>
// </ul>
message S2sStreamResponse {

    // Response type for the S2S stream. One of the following will be populated.
    oneof response {

        // full NLU detect intent response
        ondewo.nlu.DetectIntentResponse detect_intent_response = 1;

        // full T2S synthesize response
        ondewo.t2s.SynthesizeResponse synthesize_response = 2;

        // SIP trigger message
        SipTrigger sip_trigger = 3;
    }

}

// SIP trigger message.
message SipTrigger {

    // Type of SIP trigger that can be executed during a conversation.
    enum SipTriggerType {

        // should never be used
        UNSPECIFIED = 0;

        // hard hangup
        HANGUP = 1;

        // handover to human
        HUMAN_HANDOVER = 2;

        // send now
        SEND_NOW = 3;

        // pause
        PAUSE = 4;

        // transfer
        TRANSFER = 5;

        // invite to conference call
        INVITE = 6;

        // play audio
        PLAY_AUDIO = 7;

    }

    // Type of the SIP trigger.
    SipTriggerType type = 1;

    // extra parameters for the trigger
    google.protobuf.Struct content = 2;

}

// Health checks.
message CheckUpstreamHealthResponse {

    // Health checks for Speech-2-Text
    google.rpc.Status s2t_status = 1;

    // Health checks for NLU
    google.rpc.Status nlu_status = 2;

    // Health checks for Text-2-Speech
    google.rpc.Status t2s_status = 3;

}

// Control stream message.
message ControlStreamRequest{}

// Control status.
enum ControlStatus {

    // Status that control stream is ok
    OK = 0;

    // Status that control stream needs to stop immediately
    EMERGENCY_STOP = 1;

    // Status that voice activity detection detected start of speech
    VAD_START_OF_SPEECH = 2;

}

// Control stream response message.
message ControlStreamResponse{

    // Control status
    ControlStatus control_status = 1;

}

// Request to set control status.
message SetControlStatusRequest{

    // Control status
    ControlStatus control_status = 1;

}

// Response of setting the control status with the old and new status objects.
message SetControlStatusResponse{

    // Previous 'old' control status
    ControlStatus old_control_status = 1;

    // Current 'new' control status
    ControlStatus new_control_status = 2;

}

// Control message services.
enum ControlMessageServiceName {

    // Unknown control message service name
    UNKNOWNNAME = 0;

    // Speech-2-Text control message service name
    ondewo_s2t = 1;

    // Text-2-Speech control message service name
    ondewo_t2s = 2;

    // NLU control message service name
    ondewo_nlu = 3;

    // SIP control message service name
    ondewo_sip = 4;

    // VTSI control message service name
    ondewo_vtsi = 5;

    // CSI control message service name
    ondewo_csi = 6;

    // Survey control message service name
    ondewo_survey = 7;
}

// Control message methods to control services during a conversation.
enum ControlMessageServiceMethod {

    // Unknown method (default)
    UNKNOWNMETHOD = 0;

    // CSI: update configuration
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_s2t&quot;,
    //    &quot;method&quot;: &quot;update_config&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //            // Speech2TextConfig object
    //            &quot;s2tPipelineId&quot; : &quot;s2t_pipeline_german_1&quot;,
    //            &quot;languageModelName&quot; : &quot;language_model_german&quot;
    //        },
    //        {
    //             // condition_start object =&gt; should take effect immediately
    //             &quot;type&quot;: &quot;immediate&quot;,
    //             &quot;value&quot;: &quot;0&quot;
    //        },
    //        {
    //             // condition_end object - s2t config will be changed back to
    //             // last valid configuration after 10 interactions of user with
    //             // the AI agent
    //             &quot;type&quot;: &quot;interactions&quot;,
    //	           &quot;value&quot;: 10
    //        },
    //    ]
    //}
    //</code></pre>
    update_config = 1;

    // CSI: undo previous configuration update
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_s2t&quot;,
    //    &quot;method&quot;: &quot;undo_config&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //	          // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    undo_config = 2;

    // CSI: reset configuration to default
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_s2t&quot;,
    //    &quot;method&quot;: &quot;reset_config&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    reset_config = 3;

    // SIP: end conversation / hang up call
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;end_call&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    end_call = 4;

    // SIP: transfer call
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;transfer_call&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;transfer_id&quot;: &quot;+43123456789@127.0.0.10:5060&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    transfer_call = 5;

    // SIP: play wav files on the call
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;play_wav_files&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;wav_files&quot;:  [
    //                &lt;bytes_of_file_1&gt;,
    //                &lt;bytes_of_file_2&gt;,
    //                &lt;bytes_of_file_3&gt;,
    //            ]
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty “{}”
    //        },
    //    ]
    //}
    //</code></pre>
    play_wav_files = 6;

    // SIP: play a certain text on the phone based on Text-2-Speech synthesis
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;play_text&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;text&quot;: &quot;Welcome from ONDEWO AI Agent! How are you today?&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    play_text = 7;

    // SIP: mute microphone
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;mute&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    mute = 8;

    // SIP: unmute microphone
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_sip&quot;,
    //    &quot;method&quot;: &quot;un_mute&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    un_mute = 9;

    // CSI: stop the execution of all running and scheduled control messages
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;&quot;,    &lt;= empty string since it is for all services / no specific service
    //    &quot;method&quot;: &quot;stop_all_control_messages&quot;,
    //    "parameters": [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty “{}”
    //        },
    //    ]
    //}
    //</code></pre>
    stop_all_control_messages = 10;

    // NLU: train agent
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;train_agent&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    train_agent = 11;

    // NLU: cancel the ongoing agent
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;cancel_train_agent&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    cancel_train_agent = 12;

    // NLU: delete session and all session-related information
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;delete_session&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;session_id&quot;: &quot;97ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    delete_session = 13;

    // NLU: delete all context information in the current session
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;delete_all_contexts&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;session_id&quot;: &quot;97ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    delete_all_contexts = 14;

    // NLU: create a context based on the provided contextual information in the current session
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    "service": "ondewo_nlu",
    //    "method": "create_context",
    //    "parameters": [
    //        {
    //	 	      &quot;context&quot;: {           &lt;== &lt;NLU Context Object as JSON object&gt;
    //                &quot;name&quot;: &quot;projects/db46dcf8-2d2c-4115-ac38-eff443ea0e72/agent/sessions/ss2ea1a20-0784-442b-93c0-eb9e2469420e/contexts/78ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //                ...,
    //            }
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty “{}”
    //        },
    //    ]
    //}
    //</code></pre>
    create_context = 15;

    // NLU: update an existing context based on the provided contextual information in the current session
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    "service": "ondewo_nlu",
    //    "method": "update_context",
    //    "parameters": [
    //        {
    //	 	      &quot;context&quot;: {           &lt;== &lt;NLU Context Object as JSON object&gt;
    //                &quot;name&quot;: &quot;projects/db46dcf8-2d2c-4115-ac38-eff443ea0e72/agent/sessions/2dea1a20-0784-442b-93c0-eb9e2469420e/contexts/78ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //                ...,
    //            }
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty “{}”
    //        },
    //    ]
    //}
    //</code></pre>
    update_context = 16;

    // NLU: delete an existing context including all contextual information in the current session
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;delete_context&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;session_id&quot;: &quot;97ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //	 	      &quot;context_name&quot;: &quot;78ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    delete_context = 17;

    // NLU: execute a detect intent request based on the provided information in the current session
    //
    // <p>Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:</p>
    // <pre><code>
    //{
    //    &quot;service&quot;: &quot;ondewo_nlu&quot;,
    //    &quot;method&quot;: &quot;detect_intent&quot;,
    //    &quot;parameters&quot;: [
    //        {
    //	 	      &quot;session_id&quot;: &quot;97ea1a20-0784-442b-93c0-eb9e2469420e&quot;,
    //	 	      &quot;text&quot;: &quot;Are you an artificial intelligence?&quot;,
    //        },
    //        {
    //	 	      // condition_start object
    //        },
    //        {
    //	 	      // condition_end object (OPTIONAL) - for permanent change
    //            // no condition_end needs to be supplied i.e.
    //		      // this parameter is missing or empty &quot;{}&quot;
    //        },
    //    ]
    //}
    //</code></pre>
    detect_intent = 18;

}

// Type of condition that need to be satisfied to execute a control message.
enum ConditionType {

    // Unknown type
    UNKNOWTYPE = 0;

    // Immediate execution of the control message. Example value need be given as a string in the format: <pre><code>value=&quot;5&quot;</code></pre>
    immediate = 1;

    // Duration in number of seconds after a control message should be executed. Example value need be given as a string in the format: <pre><code>value=&quot;10&quot;</code></pre>
    duration = 2;

    // Date and time when a control message should be executed. Example value need be given as a string in the format: <pre><code>value=&quot;2021-12-23T13:45:00.000Z&quot;</code></pre>
    datetime = 3;

    // Number of interactions of the user with an ONDEWO AI agent after a control message should be executed. Example value need be given as a string in the format: <pre><code>value=&quot;4&quot;</code></pre>
    interactions = 4;

}

// A condition message with its type and value.
// A Condition can be of various types.
// Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:
// Immediate execution:
// <pre><code>
//{
//    &quot;type&quot;: &quot;immediate&quot;
//}
//</code></pre>
// Number of interactions of the user with the AI agent:
// <pre><code>
//{
//    &quot;type&quot;: &quot;interactions&quot;,
//    &quot;value&quot;: &quot;10&quot;
//}
//</code></pre>
// Number of seconds:
// <pre><code>
//{
//    &quot;type&quot;: &quot;duration&quot;,
//    &quot;value&quot;: &quot;3600&quot;
//}
//</code></pre>
// At a specific date and time:
// <pre><code>
//{
//    &quot;type&quot;: &quot;datetime&quot;,
//    &quot;value&quot;: &quot;2021-12-23T13:45:00.000Z&quot;
//}
//</code></pre>
message Condition{

    // Condition type
    ConditionType type = 1;

    // Value of the condition. Examples of conditions values based on the condition type are given in the <code>ConditionType</code> documentation.
    string value = 2;

}

// Parameters of the control message passed to the service specified in the control message.
message ControlMessageServiceParameters {

    // Configuration
    oneof config{

        // Text-2-Speech: configuration to control the synthesis of a text into audio
        ondewo.t2s.RequestConfig t2s_config = 1;

        // Speech-2-Text: configuration to control the recognition of text based on human voice audio
        ondewo.s2t.TranscribeRequestConfig s2t_config = 2;

    }

    // SIP: callee id to transfer call to
    string transfer_id = 3;

    // SIP: bytes of audio files to play to a caller
    repeated bytes wav_files = 4;

    // text, e.g. for NLU detect intent response or Text-2-Speech voice synthesis
    string text = 5;

    // NLU: context for creating, updating or deleting contextual information from a NLU session
    ondewo.nlu.Context context = 6;

    // NLU: the session id of a NLU session
    string session_id = 7;

    // NLU: the name of the context of a NLU session
    string context_name = 8;

    // CSI: the condition that defines when a control message should be executed
    Condition condition_start = 9;

    // CSI: the condition that defines when a control message should stop its execution
    Condition condition_end = 10;

}

// A control message.
// Example of a JSON how to invoke a control message via ONDEWO RABBITMQ service:
// <pre><code>
//{
//   &quot;service&quot;: &quot;&lt;SERVICE_NAME&gt;&quot;, 			// e.g. ondewo_s2t
//   &quot;method&quot;: &quot;&lt;SERVICE_CONTROL_METHOD&gt;&quot;, 	// e.g. update_config
//   &quot;parameters&quot;: [
//       // primitive data types and JSON objects are possible
//       1,
//       1.0,
//       -2.0,
//       &quot;string&quot;,
//       true,
//   	 {
//           // parameter JSON object
//       },
//       {
//           // Condition start object
//       },
//       {
//           // Condition end object [optional]
//       },
//    ]
//}
//</code></pre>
message ControlMessage {

    // Service to control. Valid service names are: <code>ondewo_nlu</code>, <code>ondewo_t2s</code>, <code>ondewo_s2t</code>, <code>ondewo_sip</code> and <code>ondewo_csi</code>.
    ControlMessageServiceName service = 1;

    // Method to invoke on the service
    ControlMessageServiceMethod method = 2;

    // Parameters to use to invoke the method of the service
    ControlMessageServiceParameters parameters = 3;

}
